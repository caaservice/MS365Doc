---
article: true
date: 2022-07-15
order: 6
headerDepth: 2

---

# 快速下载文件

在中国内地，下载 Onedrive for Business 的文件的速度可能会很低，导致下载文件耗时较长。这可能是由于

- 电信运营商限制访问境外网络速度
- 电信运营商故意对境外网络数据包随机丢失
- 服务器和客户距离太大导致丢包的可能性增加
- 电信运营商提供不稳定的境外网络连接线路
- 电信运营商的跨境线路流速小，无法承担起所属人的访问流量

你可以按以上因素排查问题，寻找适合你的解决方案

本文将提供快速下载文件的方法

## 直接下载（慢速）

我们先来回顾一下慢速的下载文件。

- 选中单个文件可下载单个文件
- 选中多个文件后，将下载文件组成的压缩包

![CleanShot 2022-07-26 at 00.18.49@2x.png](https://static-file.zxg.red/2022/07/26/d35631b33fb0f.png)

::: warning

由于 Onedrive for Business 对安全考虑，你无法直接使用迅雷等下载工具直接下载文件。

:::

## 多线程快速下载文件

我们可以使用多线程来下载文件以提升速度。

::: tip

线程可以理解为下载的通道，一个线程就是一个文件的下载通道，多线程也就是同时开启好几个下载通道。其实就是把一个文件打碎，然后同时下载，下载到客户电脑上后合并起来。多线程下载过程可以使用现代可视化工具来进行。

多线程可以适用于任何文件下载的提速，除非服务器限制客户端只能以单线程下载文件。

:::

### 下载 Motrix

Motrix 是开源的多线程下载工具，支持多个平台。简单易用，可以代替迅雷。下载地址: [Motrix](https://motrix.app/)

![1658766889153.png](https://static-file.zxg.red/2022/07/26/885fb2bed12c5.png)

下载任何文件都可以使用Motrix，你会发现在宽带允许的情况下，速度起飞了。

#### 提速前

<img src="https://static-file.zxg.red/2022/07/26/c740376f9c7d3.png" alt="1658767076978.png" style="zoom:50%;" />

#### 提速后

![1658767147374.png](https://static-file.zxg.red/2022/07/26/1c0dbda593882.png)

### 获取 Onedrive 文件链接

问题是，如何获得 Onedrive for business 的文件直接下载链接呢？前面说了，直接从网页拷贝的下载链接无法在下载工具里使用。 

本节提供了 Onedrive for Business 文件直接下载链接获取工具 网页版，点击使用：https://odurl.zxg.red/

::: tip

Onedrive Url Getter 帮助开发者获取 Onedrive 文件的直接下载链接。该应用程序使用Microsoft API，不会记录有关用户的任何资料。

:::

1. 从“OneDrive选择文件”按钮，等待打开新窗口。
2. 在新窗口中登陆OneDrive对应的账户并授予需要的权限。
3. 进入OneDrive“公开”文件夹内选择需要获取直链的文件（同一文件夹内可多选），点击打开。
4. 选择需要输出的掩码格式，输出面板内会自动生成对应的格式。

![86d643e1cf7ab.png](https://static-file.zxg.red/2022/07/26/7d86629e68ca3.png)

之后我们得到了链接，这个链接就是可以直接下载该文件的链接，也支持被多线程地下载。这个链接有一些长，请注意不要有遗漏，通常12小时内有效，过期后需要重新获取链接。

![CleanShot 2022-07-26 at 01.01.13@2x.png](https://static-file.zxg.red/2022/07/26/8b6c008fb1dfd.png)

我们接下来把下载链接复制到 Motrix。

![CleanShot 2022-07-26 at 01.05.20@2x.png](https://static-file.zxg.red/2022/07/26/3380e98c0d278.png)

以下测试发生在中国河北省石家庄市，使用1000M联通家庭宽带。

![360截图18430703243154.png](https://static-file.zxg.red/2022/07/26/eb50c9f6cb0cc.png)

::: tip

该方法只能获取自己的文件的下载直链，因此如果是共享文件或组文件，请设法将文件复制到你的 Onedrive for business内。

:::

## 使用国际线路

经测试，在中国内地使用 CN2/GIA 线路可有效提升下载速度。个人可通过去阿里云购买香港国际精品线路。根据中国相关法律规定，本站不提供指导内容。
